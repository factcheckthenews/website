<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="shared-styles.html">

<dom-module id="score-card">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }

      label {
        margin-right: 5px;
      }

      p {
        word-wrap: break-word;
      }
    </style>

    <div class="card" hidden="{{hidden}}">
      <h3>Summary</h3>
      <p><label>Article:</label>
        <a href="{{ result.url }}" target="_blank">{{ result.url }}</a>
      </p>

      <p><label>Score:</label>
        {{ result.score }}
      </p>

      <hr>

      <h3>Credibility Checklist:</h3>

      <!-- HTTPS Score -->
      <template is="dom-if" if="{{ !result.criteria.https }}">
        <p><label>⚠️️</label>
        This website is insecure.
        Without using HTTPS, this content could be modified by a malicious 3rd party.
        </p>
      </template>

      <template is="dom-if" if="{{ result.criteria.https }}">
        <p><label>✅</label>
          This content is served using a secure connection.
        </p>
      </template>

      <!-- OpenSources Score -->
      <template is="dom-if" if="{{ result.criteria.opensources.flag }}">
        <p><label>⚠️️</label>
        This content has been flagged by <a href="http://www.opensources.co/">OpenSources</a>
        as {{ result.criteria.opensources.type }}.</p>
      </template>

      <template is="dom-if" if="{{ !result.criteria.opensources.flag }}">
        <p><label>✅</label>
          No issues have been reported.
          If you believe there are credibility issues with this source,
          please report them to <a href="http://www.opensources.co/">OpenSources</a>.
        </p>
      </template>

      <!-- Web of Trust Result -->
      <p>
        <template is="dom-if" 
          if="{{ _displayWOTWarning(result.criteria.webOfTrust.trustworthiness.reputation) }}">
          <label>⚠️️</label>
        </template>
        <template is="dom-if" 
          if="{{ !_displayWOTWarning(result.criteria.webOfTrust.trustworthiness.reputation) }}">
          <label>✅</label>
        </template>
        <a href="https://www.mywot.com/">Web of Trust</a> users have rated the trustworthiness of this source as
        {{ result.criteria.webOfTrust.trustworthiness.description }}.
      </p>

      <!-- Web of Trust Categories -->
      <template is="dom-if" if="{{ _displayWOTCategories(result.criteria.webOfTrust.categories) }}">
        <p>
          <template is="dom-if" 
            if="{{ _displayWOTWarning(result.criteria.webOfTrust.trustworthiness.reputation) }}">
            <label>⚠️️</label>
          </template>
          <template is="dom-if" 
            if="{{ !_displayWOTWarning(result.criteria.webOfTrust.trustworthiness.reputation) }}">
            <label>✅</label>
          </template>
          Users have also categorized this site as:
        </p>

        <ul>
          <template is="dom-repeat" items="{{ result.criteria.webOfTrust.categories }}">
          <li>{{ item }}</li>
          </template>
        </ul>
      </template>

      <!-- End Report Card -->
    </div>
    
  </template>

  <script>
    Polymer({
      is: 'score-card',
      properties: {
        result: {
          type: Object,
          value: null
        },
        hidden: {
          type: Boolean,
          value: true
        }
      },
      makeVisible: function() {
        this.hidden = false
      },
      toggleVisibility: function() {
        this.hidden = !this.hidden;
      },
      _displayWOTWarning: function(reputation) {
        return (reputation < 60);
      },
      _displayWOTCategories: function(categories) {
        return (categories && categories.length > 0);
      }
    });
  </script>
</dom-module>
